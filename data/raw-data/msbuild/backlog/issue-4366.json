{
  "number": 4366,
  "title": "SSRS rptproj rdl files and assets are not copied to output directory when using /t:clean;build.",
  "body": "### Steps to reproduce\r\nRan into this issue using Azure Devops and narrowed it down to MSBuild.  If I use the targets of `clean` and `build` the files and assets (images and what not) are not copied to the `OutputPath` but if I use `/t:build` it does copy the files.  This reproduced with multiple different rptproj files including a brand new project created in Visual Studio 2019 (xml below).\r\n\r\nProject file\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<Project ToolsVersion=\"Current\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\r\n  <PropertyGroup Condition=\" '$(Configuration)' == 'Debug' \">\r\n    <FullPath>Debug</FullPath>\r\n    <OutputPath>bin\\Debug</OutputPath>\r\n    <ErrorLevel>2</ErrorLevel>\r\n    <OverwriteDatasets>False</OverwriteDatasets>\r\n    <OverwriteDataSources>False</OverwriteDataSources>\r\n    <TargetServerVersion>SSRS2016</TargetServerVersion>\r\n    <Platform>Win32</Platform>\r\n    <TargetReportFolder>NewReports</TargetReportFolder>\r\n    <TargetDatasetFolder>Datasets</TargetDatasetFolder>\r\n    <TargetDatasourceFolder>Data Sources</TargetDatasourceFolder>\r\n    <TargetReportPartFolder>Report Parts</TargetReportPartFolder>\r\n    <TargetServerURL>http://localhost/reportserver</TargetServerURL>\r\n  </PropertyGroup>\r\n  <PropertyGroup Condition=\" '$(Configuration)' == 'DebugLocal' \">\r\n    <FullPath>DebugLocal</FullPath>\r\n    <OutputPath>bin\\DebugLocal</OutputPath>\r\n    <ErrorLevel>2</ErrorLevel>\r\n    <OverwriteDatasets>False</OverwriteDatasets>\r\n    <OverwriteDataSources>False</OverwriteDataSources>\r\n    <TargetServerVersion>SSRS2016</TargetServerVersion>\r\n    <Platform>Win32</Platform>\r\n    <TargetReportFolder>NewReports</TargetReportFolder>\r\n    <TargetDatasetFolder>Datasets</TargetDatasetFolder>\r\n    <TargetDatasourceFolder>Data Sources</TargetDatasourceFolder>\r\n    <TargetReportPartFolder>Report Parts</TargetReportPartFolder>\r\n    <TargetServerURL>http://localhost/reportserver</TargetServerURL>\r\n  </PropertyGroup>\r\n  <PropertyGroup Condition=\" '$(Configuration)' == 'Release' \">\r\n    <FullPath>Release</FullPath>\r\n    <OutputPath>bin\\Release</OutputPath>\r\n    <ErrorLevel>2</ErrorLevel>\r\n    <OverwriteDatasets>False</OverwriteDatasets>\r\n    <OverwriteDataSources>False</OverwriteDataSources>\r\n    <TargetServerVersion>SSRS2016</TargetServerVersion>\r\n    <Platform>Win32</Platform>\r\n    <TargetReportFolder>NewReports</TargetReportFolder>\r\n    <TargetDatasetFolder>Datasets</TargetDatasetFolder>\r\n    <TargetDatasourceFolder>Data Sources</TargetDatasourceFolder>\r\n    <TargetReportPartFolder>Report Parts</TargetReportPartFolder>\r\n    <TargetServerURL>http://localhost/reportserver</TargetServerURL>\r\n  </PropertyGroup>\r\n  <PropertyGroup>\r\n    <State>$base64$PFNvdXJjZUNvbnRyb2xJbmZvIHhtbG5zOnhzZD0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhtbG5zOmRkbDI9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDAzL2VuZ2luZS8yIiB4bWxuczpkZGwyXzI9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDAzL2VuZ2luZS8yLzIiIHhtbG5zOmRkbDEwMF8xMDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDA4L2VuZ2luZS8xMDAvMTAwIiB4bWxuczpkZGwyMDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDEwL2VuZ2luZS8yMDAiIHhtbG5zOmRkbDIwMF8yMDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDEwL2VuZ2luZS8yMDAvMjAwIiB4bWxuczpkZGwzMDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDExL2VuZ2luZS8zMDAiIHhtbG5zOmRkbDMwMF8zMDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDExL2VuZ2luZS8zMDAvMzAwIiB4bWxuczpkZGw0MDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDEyL2VuZ2luZS80MDAiIHhtbG5zOmRkbDQwMF80MDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDEyL2VuZ2luZS80MDAvNDAwIiB4bWxuczpkZGw1MDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDEzL2VuZ2luZS81MDAiIHhtbG5zOmRkbDUwMF81MDA9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vYW5hbHlzaXNzZXJ2aWNlcy8yMDEzL2VuZ2luZS81MDAvNTAwIiB4bWxuczpkd2Q9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vRGF0YVdhcmVob3VzZS9EZXNpZ25lci8xLjAiPg0KICA8RW5hYmxlZD5mYWxzZTwvRW5hYmxlZD4NCiAgPFByb2plY3ROYW1lPjwvUHJvamVjdE5hbWU+DQogIDxBdXhQYXRoPjwvQXV4UGF0aD4NCiAgPExvY2FsUGF0aD48L0xvY2FsUGF0aD4NCiAgPFByb3ZpZGVyPjwvUHJvdmlkZXI+DQo8L1NvdXJjZUNvbnRyb2xJbmZvPg==</State>\r\n    <DataSources>@(DataSource)</DataSources>\r\n    <DataSets>@(DataSet)</DataSets>\r\n    <Reports>@(Report)</Reports>\r\n  </PropertyGroup>\r\n  <ItemGroup>\r\n    <DataSource Include=\"DataSource1.rds\" />\r\n  </ItemGroup>\r\n  <ItemGroup>\r\n    <Report Include=\"Certificate.rdl\" />\r\n  </ItemGroup>\r\n  <Import Project=\"$(MSBuildExtensionsPath)\\Reporting Services\\Microsoft.ReportingServices.MSBuilder.targets\" />\r\n</Project>\r\n```\r\n\r\nMSBuild location: `C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\\MSBuild\\Current\\Bin> `\r\n(Some paths removed to protect sensitive information)\r\nWorking MSBuild command executed:\r\n```\r\n .\\msbuild.exe \"<PathToProjectFile>\\NewReports.rptproj\" /t:\"Build\" /p:platform=\"any cpu\" /p:configuration=\"Release\" /p:VisualStudioVersion=\"16.0\"\r\n```\r\nOutput:\r\n```\r\nMicrosoft (R) Build Engine version 16.0.461+g6ff56ef63c for .NET Framework\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\nBuild started 5/10/2019 12:39:19 PM.\r\nProject \"<Path To Project>\\NewReports.rptproj\" on node 1 (Build target(s)).\r\nReportBuilderTarget:\r\n  Building the report, Certificate.rdl, for SQL Server 2016 Reporting Services.\r\n  Building the shared data source 'DataSource1.rds'.\r\nDone Building Project \"<Path to Project>\\NewReports.rptproj\" (Build target(s)).\r\n\r\n\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:00:00.19\r\n```\r\nNot Working:\r\nWorking MSBuild command executed:\r\n```\r\n .\\msbuild.exe \"<PathToProjectFile>\\NewReports.rptproj\" /t:\"Clean;Build\" /p:platform=\"any cpu\" /p:configuration=\"Release\" /p:VisualStudioVersion=\"16.0\"\r\n```\r\nOutput:\r\n```\r\nMicrosoft (R) Build Engine version 16.0.461+g6ff56ef63c for .NET Framework\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\nBuild started 5/10/2019 12:37:16 PM.\r\n\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:00:00.14\r\n```\r\n### Expected  behavior\r\nRDLs built for designated version of SQL Reporting Server should be in the designated `OutputPath` for the configuration built.\r\n\r\n### Actual behavior\r\nNo files are output to the `OutputPath`\r\n\r\n### Environment data\r\n`msbuild /version` output:\r\nLocally: Microsoft (R) Build Engine version 16.0.461+g6ff56ef63c for .NET Framework\r\nAlso reproduces on Azure Devops Pipelines\r\nOS info:\r\nWindows 10, Visual Studio 2019,  \r\nAzure Hosted 2017, Latest Visual Studio \r\n\r\nEdited to add, in Azure Devops Pipeline I had to uncheck \"clean\" in the Visual Studio Build task to get it to work there.",
  "state": "OPEN",
  "createdAt": "2019-05-10T19:47:04Z",
  "updatedAt": "2024-02-21T16:31:19Z",
  "closedAt": null,
  "author": {
    "login": "charlespaske"
  },
  "labels": [
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": {
    "title": "Discussion"
  },
  "comments": {
    "nodes": [
      {
        "body": "@peterhuene can you take a look on this issue? I remember we had something similar for the CLI and it was because there is a dependency between clean/build.",
        "createdAt": "2019-05-12T03:29:45Z",
        "updatedAt": "2019-05-12T03:29:45Z",
        "author": {
          "login": "livarcocc"
        }
      },
      {
        "body": "I have this same issue with msbuild 16.7.  \r\n\r\nmsbuild.exe \"<PathToProjectFile>\\NewReports.rptproj\" /t:\"Clean;Build\"\r\n\r\nNo files are copied to the bin\\release folder for the project.",
        "createdAt": "2021-03-02T04:08:59Z",
        "updatedAt": "2021-03-02T04:08:59Z",
        "author": {
          "login": "weberms"
        }
      }
    ]
  }
}