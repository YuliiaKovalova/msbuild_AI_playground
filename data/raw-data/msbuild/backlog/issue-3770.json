{
  "number": 3770,
  "title": "While generating the restore graph file add the location to where the package dependency version is specified",
  "body": "### Explanation\r\n\r\nI am using `Directory.Build.props` files to define package references and declare version variables (e.g. `<MoqPackageVersion>4.9.0</MoqPackageVersion>`) and reference this version variable in a Project.csproj (like `<PackageReference Include=\"Moq\" Version=\"$(MoqPackageVersion)\" />`).\r\n\r\nIt would be nice to include the location to the specific `.props` file in the restore graph from where the package was referenced or the version was specified. This enables other tools to update package version for projects that are specifing package versions through `.props` files.\r\n\r\nTest Project file\r\n```xml\r\n<Project Sdk=\"Microsoft.NET.Sdk\">\r\n\r\n  <PropertyGroup>\r\n    <TargetFramework>netcoreapp2.1</TargetFramework>\r\n  </PropertyGroup>\r\n\r\n  <ItemGroup>\r\n    <PackageReference Include=\"Microsoft.NET.Test.Sdk\" Version=\"$(MicrosoftNETTestSdkPackageVersion)\" />\r\n    <PackageReference Include=\"Moq\" Version=\"$(MoqPackageVersion)\" />\r\n    <PackageReference Include=\"xunit\" Version=\"$(XunitPackageVersion)\" />\r\n    <PackageReference Include=\"xunit.runner.visualstudio\" Version=\"$(XunitRunnerVisualStudioPackageVersion)\" />\r\n    <PackageReference Include=\"xunit.analyzers\" Version=\"$(XunitAnalyzersPackageVersion)\" />\r\n    <PackageReference Include=\"coverlet.msbuild\" Version=\"$(CoverletMSBuildPackageVersion)\">\r\n      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>\r\n      <PrivateAssets>all</PrivateAssets>\r\n    </PackageReference>\r\n    <DotNetCliToolReference Include=\"dotnet-xunit\" Version=\"$(DotNetXunitPackageVersion)\" />\r\n  </ItemGroup>\r\n\r\n</Project>\r\n```\r\n\r\nSolution directory contents:\r\n```\r\n/\r\n- build/\r\n     - dependencies.props\r\n     - sources.props\r\n- src/\r\n     - Project1/\r\n          - Project1.csproj\r\n          - Program.cs\r\n     - Project2/\r\n          - Project2.csproj\r\n          - Program.cs\r\n     - Directory.Build.props\r\n- test/\r\n     - Project1.Tests/\r\n          - Project1.Tests.csproj\r\n          - Test.cs\r\n     - Project2.Tests/\r\n          - Project2.Tests.csproj\r\n          - Test.cs\r\n     - Directory.Build.props\r\n- Directory.Build.props\r\n- Directory.Build.targets\r\n- Project.sln\r\n- NuGet.config <!-- Clears all package sources! Restore sources should be defined in build/sources.props. -->\r\n- version.props\r\n```\r\n\r\nCommand line\r\n```\r\nmsbuild PROJECT_PATH /t:GenerateRestoreGraphFile /p:RestoreGraphOutputPath=TEMP_FILE_LOCATION\r\n```\r\n\r\n### Environment data\r\n`msbuild /version` output:\r\n\r\nMicrosoft (R)-Buildmodul, Version 4.7.3056.0\r\n[Microsoft .NET Framework, Version 4.0.30319.42000]\r\nCopyright (C) Microsoft Corporation. Alle Rechte vorbehalten.\r\n\r\n4.7.3056.0\r\n\r\nOS info:\r\nEdition: Windows 10 Pro\r\nVersion: 1803\r\nBuild: 17134.285\r\n\r\ndotnet --info\r\n.NET Core SDK (reflecting any global.json):\r\n Version:   2.1.402\r\n Commit:    3599f217f4\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.17134\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\2.1.402\\\r\n\r\nHost (useful for support):\r\n  Version: 2.1.4\r\n  Commit:  85255dde3e\r\n\r\n.NET Core SDKs installed:\r\n  1.0.4 [C:\\Program Files\\dotnet\\sdk]\r\n  1.1.10 [C:\\Program Files\\dotnet\\sdk]\r\n  2.0.0 [C:\\Program Files\\dotnet\\sdk]\r\n  2.0.2 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.2 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.104 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.105 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.201 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.202 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.300-preview2-008533 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.300-rc1-008673 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.300 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.301 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.302 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.400 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.401 [C:\\Program Files\\dotnet\\sdk]\r\n  2.1.402 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET Core runtimes installed:\r\n  Microsoft.AspNetCore.All 2.1.0-preview2-final [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.0-rc1-final [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.3 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.All 2.1.4 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.All]\r\n  Microsoft.AspNetCore.App 2.1.0-preview2-final [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.0-rc1-final [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.3 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 2.1.4 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 1.0.5 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 1.0.12 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 1.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 1.1.9 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.0.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.0.3 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.0.6 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.0.7 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.0.9 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.0-preview2-26406-04 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.0-rc1 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.0 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.3 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 2.1.4 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n",
  "state": "OPEN",
  "createdAt": "2018-09-19T15:38:04Z",
  "updatedAt": "2024-02-21T16:32:56Z",
  "closedAt": null,
  "author": {
    "login": "msschl"
  },
  "labels": [
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "Thanks for the suggestion @msschl!\r\n\r\nMSBuild doesn't preserve that level of provenance information for items in the MSBuild execution model. A program using the MSBuild APIs to evaluate and build projects could get back to the XML element that created an item, but we don't expose that through item metadata. Even in the API case, we wouldn't have enough information to identify the property definition used to define the item metadata.\r\n\r\n@rrelyea -- fyi, a NuGet scenario request that would hinge on a (pretty big) MSBuild feature.\r\n\r\nI'm inclined to say that while this would be useful, it's not worth the cost, and close this.",
        "createdAt": "2018-09-19T16:17:26Z",
        "updatedAt": "2018-09-19T16:17:26Z",
        "author": {
          "login": "rainersigwald"
        }
      },
      {
        "body": "Anything planned on this feature request?",
        "createdAt": "2019-05-23T11:35:01Z",
        "updatedAt": "2019-05-23T11:35:01Z",
        "author": {
          "login": "msschl"
        }
      }
    ]
  }
}