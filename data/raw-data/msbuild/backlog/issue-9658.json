{
  "number": 9658,
  "title": "[Bug]: Copy Task retries aren't useful in Terminal Logger",
  "body": "### Issue Description\n\nWhen the Copy Task logs warnings those warnings are held back by Terminal Logger until the entire build of that relevant project finishes. This means a viewer has no opportunity to see those messages and quickly kill the offending process, making them slightly less useful, and mostly just noisy in the final output.\n\n### Steps to Reproduce\n\nIt's really easy to reproduce in the SDK:\r\n\r\n* clone the SDK\r\n* run build.cmd\r\n* run artifacts/sdk-build-env.ps1\r\n* launch VS Code\r\n* run `dotnet build` on the src/Layout/redist project\r\n\r\n\n\n### Expected Behavior\n\nThe copy errors should be visible to the user in some form earlier than the build finishing.\n\n### Actual Behavior\n\nThe errors are buffered and emitted as a single unit:\r\n\r\n```terminal\r\n$ dotnet build\r\n\r\nMSBuild version 17.10.0-preview-24060-03+1725b247e for .NET\r\nRestore complete (1.6s)\r\n  toolset-tasks net472 succeeded (1.0s) \u2192 E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net472\\toolset-tasks.dll\r\n  toolset-tasks net8.0 failed with errors (13.2s)\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 1 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 2 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 3 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 4 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 5 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 6 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 7 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 8 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 9 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): warning MSB3026: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Beginning retry 10 in 1000ms. The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): error MSB3027: Could not copy \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". Exceeded retry count of 10. Failed. The file is locked by: \".NET Host (19284)\" [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n    C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24067.4\\Microsoft.Common.CurrentVersion.targets(4787,5): error MSB3021: Unable to copy file \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\obj\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\" to \"E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll\". The process cannot access the file 'E:\\Code\\dotnet-sdk\\artifacts\\tasks\\bin\\toolset-tasks\\Debug\\net8.0\\toolset-tasks.dll' because it is being used by another process. [E:\\Code\\dotnet-sdk\\src\\Layout\\toolset-tasks\\toolset-tasks.csproj]\r\n\r\nBuild failed with errors in 15.8s\r\n```\r\n\r\nWhat's especially gross here is that each copy error is repeated - in the TL display that's double bad because we never saw the copies in the first place.\n\n### Analysis\n\n_No response_\n\n### Versions & Configurations\n\n_No response_",
  "state": "CLOSED",
  "createdAt": "2024-01-17T22:38:14Z",
  "updatedAt": "2024-06-27T13:59:12Z",
  "closedAt": "2024-06-27T13:59:11Z",
  "author": {
    "login": "baronfel"
  },
  "labels": [
    "bug",
    "Priority:2",
    "triaged",
    "Area: Terminal Logger"
  ],
  "assignees": {
    "nodes": [
      {
        "login": "surayya-MS"
      }
    ]
  },
  "milestone": {
    "title": ".NET 9.0"
  },
  "comments": {
    "nodes": [
      {
        "body": "This could potentially be resolved by making the Copy Task use whatever progress-reporting or ephemeral message APIs we create.",
        "createdAt": "2024-02-12T18:11:44Z",
        "updatedAt": "2024-02-12T18:11:44Z",
        "author": {
          "login": "baronfel"
        }
      }
    ]
  }
}