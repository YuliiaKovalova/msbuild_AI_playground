{
  "number": 10784,
  "title": "[Unhandled Exception]: The paging file is too small for this operation to complete.",
  "body": "### Issue Description\n\nBuilding a Visual Studio solution with mixed C++ and C# projects.\n\nFirst build failure: `Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'Microsoft.CodeAnalysis.CSharp, Version=4.11.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The paging file is too small for this operation to complete. (Exception from HRESULT: 0x800705AF)`\n\nFollowed by four identical `This is an unhandled exception in MSBuild` failures with the same message and stack trace.\n\n\n\n### Steps to Reproduce\n\n1. Edited some C++ code in Visual Studio.\n2. Started a \"Build Solution\"\n3. The C++ library project built. Looks like it was okay.\n4. The first C# project failed: `Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'Microsoft.CodeAnalysis.CSharp, Version=4.11.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The paging file is too small for this operation to complete. (Exception from HRESULT: 0x800705AF)`\n5. The next four C# projects failed with `This is an unhandled exception in MSBuild`. The error message and stack trace look the same for all four failures.\n\nI am not expecting to be able to reproduce this issue. I restarted the PC and was able to build successfully.\n\n### Actual Behavior\n\n```\nBuild started at 4:33 PM...\n1>------ Build started: Project: Asdf.Native, Configuration: Release x64 ------\n1>NativeAsdf.cpp\n1>   Creating library C:\\bd\\src\\Asdf\\Asdf.Native\\Output\\Asdf.Native.lib and object C:\\bd\\src\\Asdf\\Asdf.Native\\Output\\Asdf.Native.exp\n1>Generating code\n1>16 of 787 functions ( 2.0%) were compiled, the rest were copied from previous compilation.\n1>  13 functions were new in current compilation\n1>  0 functions had inline decision re-evaluated but remain unchanged\n1>Finished generating code\n1>Asdf.Native.vcxproj -> C:\\bd\\src\\Asdf\\Asdf.Native\\Output\\Asdf.Native.dll\n2>------ Build started: Project: Asdf, Configuration: Debug x64 ------\n2>C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Current\\Bin\\Roslyn\\Microsoft.CSharp.Core.targets(85,5): error :\n2>C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Current\\Bin\\Roslyn\\Microsoft.CSharp.Core.targets(85,5): error : Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'Microsoft.CodeAnalysis.CSharp, Version=4.11.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The paging file is too small for this operation to complete. (Exception from HRESULT: 0x800705AF)\n2>C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Current\\Bin\\Roslyn\\Microsoft.CSharp.Core.targets(85,5): error :    at Microsoft.CodeAnalysis.CSharp.CommandLine.Program.MainCore(String[] args)\n2>C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Current\\Bin\\Roslyn\\Microsoft.CSharp.Core.targets(85,5): error :    at Microsoft.CodeAnalysis.CSharp.CommandLine.Program.Main(String[] args)\n2>Done building project \"Asdf.csproj\" -- FAILED.\n3>------ Build started: Project: Asdf.Test, Configuration: Debug x64 ------\n4>------ Build started: Project: Ghjk.Test, Configuration: Debug x64 ------\n5>------ Build started: Project: Zxcv.Test, Configuration: Debug x64 ------\n6>------ Build started: Project: Tyui.Specflow.Test, Configuration: Debug x64 ------\n6>SpecFlowFeatureFiles: Features\\Tyui.feature;Features\\Qwer.feature\n3>MSBUILD : error : This is an unhandled exception in MSBuild -- PLEASE UPVOTE AN EXISTING ISSUE OR FILE A NEW ONE AT https://aka.ms/msbuild/unhandled\n3>MSBUILD : error :     System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.\n3>MSBUILD : error :    at Go2(RegexRunner )\n3>MSBUILD : error :    at System.Text.RegularExpressions.RegexRunner.Scan(Regex regex, String text, Int32 textbeg, Int32 textend, Int32 textstart, Int32 prevlen, Boolean quick, TimeSpan timeout)\n3>MSBUILD : error :    at System.Text.RegularExpressions.Regex.Run(Boolean quick, Int32 prevlen, String input, Int32 beginning, Int32 length, Int32 startat)\n3>MSBUILD : error :    at System.Text.RegularExpressions.Regex.Match(String input, Int32 startat)\n3>MSBUILD : error :    at System.Text.RegularExpressions.RegexReplacement.Replace(MatchEvaluator evaluator, Regex regex, String input, Int32 count, Int32 startat)\n3>MSBUILD : error :    at System.Text.RegularExpressions.Regex.Replace(String input, MatchEvaluator evaluator)\n3>MSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.MetadataExpander.ExpandMetadataLeaveEscaped(String expression, IMetadataTable metadata, ExpanderOptions options, IElementLocation elementLocation, LoggingContext loggingContext)\n3>MSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ExpandIntoStringLeaveEscaped(String expression, ExpanderOptions options, IElementLocation elementLocation)\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.LogSkippedTask(ItemBucket bucket, TaskExecutionMode howToExecuteTask)\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.<ExecuteBucket>d__19.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.<ExecuteTask>d__18.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.<ExecuteTask>d__13.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TargetEntry.<ProcessBucket>d__51.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TargetEntry.<ExecuteTarget>d__44.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TargetBuilder.<ProcessTargetStack>d__23.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.TargetBuilder.<BuildTargets>d__10.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.RequestBuilder.<BuildProject>d__67.MoveNext()\n3>MSBUILD : error : --- End of stack trace from previous location where exception was thrown ---\n3>MSBUILD : error :    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n3>MSBUILD : error :    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\n3>MSBUILD : error :    at Microsoft.Build.BackEnd.RequestBuilder.<RequestThreadProc>d__58.MoveNext()\n3>Done building project \"Asdf.Test.csproj\" -- FAILED.\n```\n\n### Analysis\n\n_No response_\n\n### Versions & Configurations\n\nMicrosoft Visual Studio Enterprise 2022 (64-bit) - Current Version 17.11.4\n\nMSBuild version 17.11.9+a69bbaaf5 for .NET Framework\n17.11.9.46202\n",
  "state": "CLOSED",
  "createdAt": "2024-10-10T01:24:21Z",
  "updatedAt": "2024-10-23T13:40:23Z",
  "closedAt": "2024-10-23T13:40:21Z",
  "author": {
    "login": "TomBecker-BD"
  },
  "labels": [
    "bug",
    "author-responded"
  ],
  "assignees": {
    "nodes": [
      {
        "login": "maridematte"
      }
    ]
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "Hello, thank you for filling the issue regarding your build as the message indicates. This failure seems to be related to the `OutOfMemoryException`, which means your system might not have enough memory to run the build. \nCould you check that:\n1) Your system was doing any memory heavy processing task at the same time as the build? \n2) Can you reproduce this with nothing else running on your machine?",
        "createdAt": "2024-10-22T15:56:37Z",
        "updatedAt": "2024-10-22T15:56:37Z",
        "author": {
          "login": "maridematte"
        }
      },
      {
        "body": "1. The system where this happened has 32 GB of RAM. The paging file is 36864 MB. I probably had Outlook, Teams, VS Code, and one tab in Chrome open at the time, not actively doing anything in any of them. No heavy processing except for running MSBuild.\n2. I don't expect to be able to reproduce the problem. It seems like a rare glitch. MSBuild asked me to file an issue, so I did.\n\nThe original exception was: \"Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'Microsoft.CodeAnalysis.CSharp, Version=4.11.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The paging file is too small for this operation to complete. (Exception from HRESULT: 0x800705AF)\". \n\nThe System.OutOfMemoryException came later. ",
        "createdAt": "2024-10-22T22:41:13Z",
        "updatedAt": "2024-10-22T22:41:13Z",
        "author": {
          "login": "TomBecker-BD"
        }
      },
      {
        "body": "MSBuild doesn't handle `System.OutOfMemoryException` very well, and it ends up throwing other unrelated exception depending on where it ran out of memory. \n\nWe do appreciate bug and issue reports, and make an effort to look into all of them. If you do not expect to run into this issue again, I will close this issue. If you happen to run into it again, please feel free to reopen it and we can work together to collect more information on it.",
        "createdAt": "2024-10-23T13:40:21Z",
        "updatedAt": "2024-10-23T13:40:21Z",
        "author": {
          "login": "maridematte"
        }
      }
    ]
  }
}