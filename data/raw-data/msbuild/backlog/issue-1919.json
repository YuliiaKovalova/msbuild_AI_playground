{
  "number": 1919,
  "title": "MSBuild 15 creates an assembly info file and fails to compile it..",
  "body": "## Steps to reproduce the problem:\r\n\r\n- create an empty .NET Standard (1.3) library\r\n- delete the`obj` and `bin` sub-folders\r\n- at the command line, type :  `msbuild <project-name>.csproj`\r\n- MSBuild creates the following file at `obj\\Debug\\netstandard1.3\\<project-name>.AssemblyInfo.cs`:\r\n\r\n```\r\n//------------------------------------------------------------------------------\r\n// <auto-generated>\r\n//     This code was generated by a tool.\r\n//     Runtime Version:4.0.30319.42000\r\n//\r\n//     Changes to this file may cause incorrect behavior and will be lost if\r\n//     the code is regenerated.\r\n// </auto-generated>\r\n//------------------------------------------------------------------------------\r\n\r\nusing System;\r\nusing System.Reflection;\r\n\r\n[assembly: System.Reflection.AssemblyCompanyAttribute(\"xxx\")]\r\n[assembly: System.Reflection.AssemblyConfigurationAttribute(\"Debug\")]\r\n[assembly: System.Reflection.AssemblyDescriptionAttribute(\"Package Description\")]\r\n[assembly: System.Reflection.AssemblyFileVersionAttribute(\"1.0.0.0\")]\r\n[assembly: System.Reflection.AssemblyInformationalVersionAttribute(\"1.0.0\")]\r\n[assembly: System.Reflection.AssemblyProductAttribute(\"xxx\")]\r\n[assembly: System.Reflection.AssemblyTitleAttribute(\"xxx\")]\r\n[assembly: System.Reflection.AssemblyVersionAttribute(\"1.0.0.0\")]\r\n\r\n// Generated by the MSBuild WriteCodeFragment class.\r\n```\r\n\r\n- as these attributes are no longer supported in .NET Standard projects the compilation fails.\r\n\r\n> The problem does not appear when the folder `obj\\Debug\\netstandard1.3` exists.",
  "state": "CLOSED",
  "createdAt": "2017-03-28T12:06:16Z",
  "updatedAt": "2024-02-21T17:20:19Z",
  "closedAt": "2018-09-05T15:46:04Z",
  "author": {
    "login": "rvuistin"
  },
  "labels": [
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "@jeffkl any idea why this is happening?",
        "createdAt": "2017-03-28T13:34:20Z",
        "updatedAt": "2017-03-28T13:34:20Z",
        "author": {
          "login": "epsitec"
        }
      },
      {
        "body": "Did you restore after deleting the obj folder? Deleting that folder is pretty much undoing restore as well so there won't be any compilation references that define all the attributes..",
        "createdAt": "2017-03-28T13:39:32Z",
        "updatedAt": "2017-03-28T13:39:32Z",
        "author": {
          "login": "dasMulli"
        }
      },
      {
        "body": "No I didn't restore, I know I should, but don't you think it's odd that msbuild creates a file containing non-compilable attributes. And don't you think that the msbuild script code that generates the file should be deleted or at least modified...",
        "createdAt": "2017-03-28T13:50:28Z",
        "updatedAt": "2017-03-28T13:50:28Z",
        "author": {
          "login": "rvuistin"
        }
      },
      {
        "body": ">And don't you think that the msbuild script code that generates the file should be deleted or at least modified...\r\n\r\nI'm not sure this would make the situation any better.. If the `obj/project.assets.json` file is missing, not even `System.Object` is valid and no code will be able to compile. Even if you turn off assembly info generation via `<GenerateAssemblyInfo>false</GenerateAssemblyInfo>`, none of the other code in the library would be able to compile successfully.\r\n\r\nI believe that it would be better to invest more into a meaningful error message saying that the project has not been restored which is tracked by https://github.com/Microsoft/msbuild/issues/1139.\r\n\r\n(Note: i'm not affiliated with MS).",
        "createdAt": "2017-03-28T14:12:14Z",
        "updatedAt": "2017-03-28T14:12:14Z",
        "author": {
          "login": "dasMulli"
        }
      },
      {
        "body": "Thank you very much for your explanations. You are right, I tried to turn off assembly info generation and I get an error saying : `project.assets.json` not found.\r\n\r\nStill good to know that assembly info generation code should be disabled when building .NET standard / Core projects...",
        "createdAt": "2017-03-28T14:32:04Z",
        "updatedAt": "2017-03-28T14:32:04Z",
        "author": {
          "login": "rvuistin"
        }
      },
      {
        "body": "Just to be clear, the ability to disable generation of those attributes is helpful in cases where you already have an AssemblyInfo.cs file in your project (and maybe have tooling for it - e.g. GitFlow) or don't want one of the generated attributes to be generated (each one can be controlled via properties like `GenerateAssemblyCompanyAttribute`).\r\nEvery attribute is valid on and can be used for .net standard and .net core projects.",
        "createdAt": "2017-03-28T14:42:07Z",
        "updatedAt": "2017-03-28T14:42:07Z",
        "author": {
          "login": "dasMulli"
        }
      },
      {
        "body": "\ud83d\udc4d Thank you again... I should have looked at the error message of the compiler saying:\r\n\r\n`error CS0579: Duplicate 'System.Reflection.AssemblyCompanyAttribute' attribute`",
        "createdAt": "2017-03-28T15:03:46Z",
        "updatedAt": "2017-03-28T15:03:46Z",
        "author": {
          "login": "rvuistin"
        }
      },
      {
        "body": "Hope the documentation will explain this type of things...",
        "createdAt": "2017-03-28T15:05:35Z",
        "updatedAt": "2017-03-28T15:05:35Z",
        "author": {
          "login": "rvuistin"
        }
      },
      {
        "body": "If you keep AssemplyAttributes in AssemblyInfo.cs, you can turn off auto-generated assembly attributes.\r\nin csproj:\r\n\r\n         <PropertyGroup>\r\n              <GenerateAssemblyInfo>false</GenerateAssemblyInfo>\r\n        </PropertyGroup> \r\n\r\nNow, no file is generated and sucess compilation",
        "createdAt": "2018-09-05T14:44:43Z",
        "updatedAt": "2018-09-06T17:13:38Z",
        "author": {
          "login": "moh-hassan"
        }
      },
      {
        "body": "Sounds like this had a better error than it seemed at first glance and was resolved by restoring.",
        "createdAt": "2018-09-05T15:46:04Z",
        "updatedAt": "2018-09-05T15:46:04Z",
        "author": {
          "login": "rainersigwald"
        }
      }
    ]
  }
}