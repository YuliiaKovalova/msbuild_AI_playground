{
  "number": 5138,
  "title": "Why msbuild compiles both in Debug and in Release when just the Release is requested in a certain scenario?",
  "body": "### Steps to reproduce\r\n\r\n**DataSvc.sln**\r\n```\r\nMicrosoft Visual Studio Solution File, Format Version 12.00\r\n# Visual Studio 15\r\nVisualStudioVersion = 15.0.28010.2048\r\nMinimumVisualStudioVersion = 10.0.40219.1\r\nProject(\"{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}\") = \"Common\", \"Common\\Common.csproj\", \"{04455D86-A7A4-41E5-B3ED-B0BC65EAFDFD}\"\r\nEndProject\r\nProject(\"{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}\") = \"Compensation.Data\", \"Compensation.Data\\Compensation.Data.csproj\", \"{04DF77A2-912B-40B7-B398-E9558519CAEE}\"\r\nEndProject\r\nGlobal\r\n\tGlobalSection(SolutionConfigurationPlatforms) = preSolution\r\n\t\tDebug|Any CPU = Debug|Any CPU\r\n\t\tRelease|Any CPU = Release|Any CPU\r\n\tEndGlobalSection\r\n\tGlobalSection(ProjectConfigurationPlatforms) = postSolution\r\n\t\t{04455D86-A7A4-41E5-B3ED-B0BC65EAFDFD}.Debug|Any CPU.ActiveCfg = Debug|Any CPU\r\n\t\t{04455D86-A7A4-41E5-B3ED-B0BC65EAFDFD}.Debug|Any CPU.Build.0 = Debug|Any CPU\r\n\t\t{04455D86-A7A4-41E5-B3ED-B0BC65EAFDFD}.Release|Any CPU.ActiveCfg = Release|Any CPU\r\n\t\t{04455D86-A7A4-41E5-B3ED-B0BC65EAFDFD}.Release|Any CPU.Build.0 = Release|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Debug|Any CPU.ActiveCfg = Debug|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Debug|Any CPU.Build.0 = Debug|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Release|Any CPU.ActiveCfg = Release|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Release|Any CPU.Build.0 = Release|Any CPU\r\n\tEndGlobalSection\r\n\tGlobalSection(SolutionProperties) = preSolution\r\n\t\tHideSolutionNode = FALSE\r\n\tEndGlobalSection\r\n\tGlobalSection(ExtensibilityGlobals) = postSolution\r\n\t\tSolutionGuid = {9ED7ECEC-075D-486A-B3F6-9E80EED49AEF}\r\n\tEndGlobalSection\r\nEndGlobal\r\n```\r\n\r\n**Main.sln**\r\n```\r\nMicrosoft Visual Studio Solution File, Format Version 12.00\r\n# Visual Studio 15\r\nVisualStudioVersion = 15.0.28010.2026\r\nMinimumVisualStudioVersion = 10.0.40219.1\r\nProject(\"{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}\") = \"Compensation.Data\", \"Compensation.Data\\Compensation.Data.csproj\", \"{04DF77A2-912B-40B7-B398-E9558519CAEE}\"\r\nEndProject\r\nGlobal\r\n\tGlobalSection(SolutionConfigurationPlatforms) = preSolution\r\n\t\tDebug|Any CPU = Debug|Any CPU\r\n\t\tRelease|Any CPU = Release|Any CPU\r\n\tEndGlobalSection\r\n\tGlobalSection(ProjectConfigurationPlatforms) = postSolution\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Debug|Any CPU.ActiveCfg = Debug|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Debug|Any CPU.Build.0 = Debug|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Release|Any CPU.ActiveCfg = Release|Any CPU\r\n\t\t{04DF77A2-912B-40B7-B398-E9558519CAEE}.Release|Any CPU.Build.0 = Release|Any CPU\r\n\tEndGlobalSection\r\n\tGlobalSection(SolutionProperties) = preSolution\r\n\t\tHideSolutionNode = FALSE\r\n\tEndGlobalSection\r\n\tGlobalSection(ExtensibilityGlobals) = postSolution\r\n\t\tSolutionGuid = {6FBE2C7C-DCEA-4F88-BF8E-FF4927DEFBE5}\r\n\tEndGlobalSection\r\nEndGlobal\r\n```\r\n**Common\\Common.csproj**\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<Project ToolsVersion=\"14.0\" DefaultTargets=\"Build\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\r\n  <Import Project=\"$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props\" />\r\n  <PropertyGroup>\r\n    <Configuration Condition=\" '$(Configuration)' == '' \">Debug</Configuration>\r\n    <Platform Condition=\" '$(Platform)' == '' \">AnyCPU</Platform>\r\n    <ProductVersion>8.0.30703</ProductVersion>\r\n    <SchemaVersion>2.0</SchemaVersion>\r\n    <ProjectGuid>{04455D86-A7A4-41E5-B3ED-B0BC65EAFDFD}</ProjectGuid>\r\n    <OutputType>Library</OutputType>\r\n    <AppDesignerFolder>Properties</AppDesignerFolder>\r\n    <RootNamespace>Xyz.Common</RootNamespace>\r\n    <AssemblyName>Xyz.Common</AssemblyName>\r\n    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>\r\n    <FileAlignment>512</FileAlignment>\r\n    <OutputPath>Bin\\$(Configuration)</OutputPath>\r\n  </PropertyGroup>\r\n  <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' \">\r\n    <DefineConstants>DEBUG;TRACE</DefineConstants>\r\n  </PropertyGroup>\r\n  <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' \">\r\n    <DefineConstants>TRACE</DefineConstants>\r\n  </PropertyGroup>\r\n  <Import Project=\"$(MSBuildToolsPath)\\Microsoft.CSharp.targets\" />\r\n</Project>\r\n```\r\n**Compensation.Data.csproj**\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<Project ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\r\n  <Import Project=\"$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props\" Condition=\"Exists('$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props')\" />\r\n  <PropertyGroup>\r\n    <Configuration Condition=\" '$(Configuration)' == '' \">Debug</Configuration>\r\n    <Platform Condition=\" '$(Platform)' == '' \">AnyCPU</Platform>\r\n    <ProjectGuid>{04DF77A2-912B-40B7-B398-E9558519CAEE}</ProjectGuid>\r\n    <OutputType>Library</OutputType>\r\n    <AppDesignerFolder>Properties</AppDesignerFolder>\r\n    <RootNamespace>Compensation.Data</RootNamespace>\r\n    <AssemblyName>Compensation.Data</AssemblyName>\r\n    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>\r\n    <FileAlignment>512</FileAlignment>\r\n    <Deterministic>true</Deterministic>\r\n    <OutputPath>Bin\\$(Configuration)</OutputPath>\r\n  </PropertyGroup>\r\n  <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' \">\r\n    <DefineConstants>DEBUG;TRACE</DefineConstants>\r\n  </PropertyGroup>\r\n  <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' \">\r\n    <DefineConstants>TRACE</DefineConstants>\r\n  </PropertyGroup>\r\n  <ItemGroup>\r\n    <ProjectReference Include=\"..\\Common\\Common.csproj\">\r\n      <Project>{04455d86-a7a4-41e5-b3ed-b0bc65eafdfd}</Project>\r\n      <Name>Common</Name>\r\n    </ProjectReference>\r\n  </ItemGroup>\r\n  <Import Project=\"$(MSBuildToolsPath)\\Microsoft.CSharp.targets\" />\r\n</Project>\r\n```\r\nCommand line\r\n```\r\nC:\\work\\MSBuildBug [master]> msbuild .\\DataSvc.sln /p:Configuration=Release /v:m /noWarn:CS2008\r\nMicrosoft (R) Build Engine version 16.3.2+e481bbf88 for .NET Framework\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  Common -> C:\\work\\MSBuildBug\\Common\\Bin\\Release\\Xyz.Common.dll\r\n  Compensation.Data -> C:\\work\\MSBuildBug\\Compensation.Data\\Bin\\Release\\Compensation.Data.dll\r\nC:\\work\\MSBuildBug [master]> msbuild .\\Main.sln /p:Configuration=Release /v:m /noWarn:CS2008\r\nMicrosoft (R) Build Engine version 16.3.2+e481bbf88 for .NET Framework\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  Common -> C:\\work\\MSBuildBug\\Common\\Bin\\Debug\\Xyz.Common.dll\r\n  Compensation.Data -> C:\\work\\MSBuildBug\\Compensation.Data\\Bin\\Release\\Compensation.Data.dll\r\nC:\\work\\MSBuildBug [master]>\r\n```\r\n### Expected behavior\r\n\r\nNo projects are compiled in Debug\r\n\r\n### Actual behavior\r\n\r\nIn the Main solution the Common project is compiled in Debug.\r\n\r\n### Environment data\r\n`msbuild /version` output: 16.3.2.50909\r\n\r\nOS info: Windows 10\r\n\r\n### Notes\r\nThings to note:\r\n\r\n 1. The `Compensation.Data` project is loaded both in DataSvc.sln and Main.sln\r\n 1. The `Compensation.Data` project references the `Common` project as a project, not DLL, even though it is not found in `Main.sln`\r\n\r\nhttps://stackoverflow.com/questions/60274983/why-msbuild-compiles-both-in-debug-and-in-release-when-just-the-release-is-reque",
  "state": "CLOSED",
  "createdAt": "2020-02-20T23:30:23Z",
  "updatedAt": "2024-02-21T17:04:59Z",
  "closedAt": "2020-02-24T19:44:28Z",
  "author": {
    "login": "MarkKharitonov"
  },
  "labels": [
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "https://github.com/microsoft/msbuild/issues/5116#issuecomment-584211463 has an explanation of this confusing-but-by-design behavior.",
        "createdAt": "2020-02-24T19:44:28Z",
        "updatedAt": "2020-02-24T19:44:28Z",
        "author": {
          "login": "rainersigwald"
        }
      }
    ]
  }
}