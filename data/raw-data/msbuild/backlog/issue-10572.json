{
  "number": 10572,
  "title": "MSBUILD : error :     System.NullReferenceException: Object reference not set to an instance of an object",
  "body": "### Issue Description\n\n> [builder 4/4] RUN dotnet publish Jellyfin.Server --disable-parallel --configuration Release --output=\"/jellyfin\" --self-contained --runtime linux-x64 -p:DebugSymbols=false -p:DebugType=none:                                                                                                                                                                           \r\n13.43 MSBUILD : error : This is an unhandled exception in MSBuild -- PLEASE UPVOTE AN EXISTING ISSUE OR FILE A NEW ONE AT https://aka.ms/msbuild/unhandled [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                                                                                                                   \r\n13.43 MSBUILD : error :     System.NullReferenceException: Object reference not set to an instance of an object. [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                       \r\n13.43 MSBUILD : error :    at Regex1_Scan(RegexRunner, ReadOnlySpan`1) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                 \r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.ScanInternal(RegexRunnerMode mode, Boolean reuseMatchObject, String input, Int32 beginning, RegexRunner runner, ReadOnlySpan`1 span, Boolean returnNullIfReuseMatchObject) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                                \r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.RunAllMatchesWithCallback[TState](String inputString, ReadOnlySpan`1 inputSpan, Int32 startat, TState& state, MatchCallback`1 callback, RegexRunnerMode mode, Boolean reuseMatchObject) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                   \r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.RunAllMatchesWithCallback[TState](String input, Int32 startat, TState& state, MatchCallback`1 callback, RegexRunnerMode mode, Boolean reuseMatchObject) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.Replace(MatchEvaluator evaluator, Regex regex, String input, Int32 count, Int32 startat) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.MetadataExpander.ExpandMetadataLeaveEscaped(String expression, IMetadataTable metadata, ExpanderOptions options, IElementLocation elementLocation, LoggingContext loggingContext) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ExpandIntoStringLeaveEscaped(String expression, ExpanderOptions options, IElementLocation elementLocation) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.EvaluateItemDefinitionElement(ProjectItemDefinitionElement itemDefinitionElement) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.EvaluateItemDefinitionGroupElement(ProjectItemDefinitionGroupElement itemDefinitionGroupElement) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.Evaluate() [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.Evaluate(IEvaluatorData`4 data, Project project, ProjectRootElement root, ProjectLoadSettings loadSettings, Int32 maxNodeCount, PropertyDictionary`1 environmentProperties, ILoggingService loggingService, IItemFactory`2 itemFactory, IToolsetProvider toolsetProvider, IDirectoryCacheFactory directoryCacheFactory, ProjectRootElementCacheBase projectRootElementCache, BuildEventContext buildEventContext, ISdkResolverService sdkResolverService, Int32 submissionId, EvaluationContext evaluationContext, Boolean interactive) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Execution.ProjectInstance.Initialize(ProjectRootElement xml, IDictionary`2 globalProperties, String explicitToolsVersion, String explicitSubToolsetVersion, Int32 visualStudioVersionFromSolution, BuildParameters buildParameters, ILoggingService loggingService, BuildEventContext buildEventContext, ISdkResolverService sdkResolverService, Int32 submissionId, Nullable`1 projectLoadSettings, EvaluationContext evaluationContext, IDirectoryCacheFactory directoryCacheFactory) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Execution.ProjectInstance..ctor(String projectFile, IDictionary`2 globalProperties, String toolsVersion, BuildParameters buildParameters, ILoggingService loggingService, BuildEventContext buildEventContext, ISdkResolverService sdkResolverService, Int32 submissionId, Nullable`1 projectLoadSettings) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.BuildRequestConfiguration.<>c__DisplayClass61_0.<LoadProjectIntoConfiguration>b__0() [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.BuildRequestConfiguration.InitializeProject(BuildParameters buildParameters, Func`1 loadProjectFromFile) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.RequestBuilder.BuildProject() [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.RequestBuilder.RequestThreadProc(Boolean setThreadParameters) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\n\n### Steps to Reproduce\n\nThis is an unhandled exception in MSBuild -- PLEASE UPVOTE AN EXISTING ISSUE OR FILE A NEW ONE AT https://aka.ms/msbuild/unhandled [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\n\n### Actual Behavior\n\nThis is an unhandled exception in MSBuild -- PLEASE UPVOTE AN EXISTING ISSUE OR FILE A NEW ONE AT https://aka.ms/msbuild/unhandled [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\n\n### Analysis\n\nno\n\n### Versions & Configurations\n\n10.9.x",
  "state": "CLOSED",
  "createdAt": "2024-08-27T02:29:03Z",
  "updatedAt": "2024-10-25T12:50:35Z",
  "closedAt": "2024-10-25T12:50:32Z",
  "author": {
    "login": "liuqinghongl"
  },
  "labels": [
    "bug",
    "needs-more-info",
    "needs-investigation",
    "stale",
    "closed-by-bot",
    "triaged"
  ],
  "assignees": {
    "nodes": [
      {
        "login": "GangWang01"
      }
    ]
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "13.43 MSBUILD : error : This is an unhandled exception in MSBuild -- PLEASE UPVOTE AN EXISTING ISSUE OR FILE A NEW ONE AT https://aka.ms/msbuild/unhandled [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                                                                                                                   \r\n13.43 MSBUILD : error :     System.NullReferenceException: Object reference not set to an instance of an object. [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                       \r\n13.43 MSBUILD : error :    at Regex1_Scan(RegexRunner, ReadOnlySpan`1) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                 \r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.ScanInternal(RegexRunnerMode mode, Boolean reuseMatchObject, String input, Int32 beginning, RegexRunner runner, ReadOnlySpan`1 span, Boolean returnNullIfReuseMatchObject) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                                \r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.RunAllMatchesWithCallback[TState](String inputString, ReadOnlySpan`1 inputSpan, Int32 startat, TState& state, MatchCallback`1 callback, RegexRunnerMode mode, Boolean reuseMatchObject) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]                                                                   \r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.RunAllMatchesWithCallback[TState](String input, Int32 startat, TState& state, MatchCallback`1 callback, RegexRunnerMode mode, Boolean reuseMatchObject) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at System.Text.RegularExpressions.Regex.Replace(MatchEvaluator evaluator, Regex regex, String input, Int32 count, Int32 startat) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.MetadataExpander.ExpandMetadataLeaveEscaped(String expression, IMetadataTable metadata, ExpanderOptions options, IElementLocation elementLocation, LoggingContext loggingContext) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ExpandIntoStringLeaveEscaped(String expression, ExpanderOptions options, IElementLocation elementLocation) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.EvaluateItemDefinitionElement(ProjectItemDefinitionElement itemDefinitionElement) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.EvaluateItemDefinitionGroupElement(ProjectItemDefinitionGroupElement itemDefinitionGroupElement) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.Evaluate() [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Evaluation.Evaluator`4.Evaluate(IEvaluatorData`4 data, Project project, ProjectRootElement root, ProjectLoadSettings loadSettings, Int32 maxNodeCount, PropertyDictionary`1 environmentProperties, ILoggingService loggingService, IItemFactory`2 itemFactory, IToolsetProvider toolsetProvider, IDirectoryCacheFactory directoryCacheFactory, ProjectRootElementCacheBase projectRootElementCache, BuildEventContext buildEventContext, ISdkResolverService sdkResolverService, Int32 submissionId, EvaluationContext evaluationContext, Boolean interactive) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Execution.ProjectInstance.Initialize(ProjectRootElement xml, IDictionary`2 globalProperties, String explicitToolsVersion, String explicitSubToolsetVersion, Int32 visualStudioVersionFromSolution, BuildParameters buildParameters, ILoggingService loggingService, BuildEventContext buildEventContext, ISdkResolverService sdkResolverService, Int32 submissionId, Nullable`1 projectLoadSettings, EvaluationContext evaluationContext, IDirectoryCacheFactory directoryCacheFactory) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.Execution.ProjectInstance..ctor(String projectFile, IDictionary`2 globalProperties, String toolsVersion, BuildParameters buildParameters, ILoggingService loggingService, BuildEventContext buildEventContext, ISdkResolverService sdkResolverService, Int32 submissionId, Nullable`1 projectLoadSettings) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.BuildRequestConfiguration.<>c__DisplayClass61_0.<LoadProjectIntoConfiguration>b__0() [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.BuildRequestConfiguration.InitializeProject(BuildParameters buildParameters, Func`1 loadProjectFromFile) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.RequestBuilder.BuildProject() [/repo/Jellyfin.Server/Jellyfin.Server.csproj]\r\n13.43 MSBUILD : error :    at Microsoft.Build.BackEnd.RequestBuilder.RequestThreadProc(Boolean setThreadParameters) [/repo/Jellyfin.Server/Jellyfin.Server.csproj]",
        "createdAt": "2024-08-27T02:29:27Z",
        "updatedAt": "2024-08-27T02:29:27Z",
        "author": {
          "login": "liuqinghongl"
        }
      },
      {
        "body": "RUN dotnet publish Jellyfin.Server --configuration Release --output=\"/jellyfin\" --self-contained --runtime linux-arm64 -p:DebugSymbols=false -p:DebugType=none",
        "createdAt": "2024-08-27T08:08:11Z",
        "updatedAt": "2024-08-27T08:08:11Z",
        "author": {
          "login": "liuqinghongl"
        }
      },
      {
        "body": "@liuqinghongl from the provided info I guess Jellyfin.Server is in [Jellyfin](https://github.com/jellyfin/jellyfin) that guides how to [build from source](https://jellyfin.org/docs/general/installation/source/). The build happened on linux. I tried to reproduce this issue on linux using both non-container image and container image following the guide. Build succeeded. I couldn't reproduce this issue. The used dotnet version was 8.0.401.\r\n\r\nIf my guess is wrong, can you provide detailed info to help reproducing the issue including the following? \r\n- The source code or an example project to produce.\r\n- Steps to reproduce.\r\n- dotnet info - run the command `dotnet --info` to get\r\n- OS: Linux, Windows or macOS.",
        "createdAt": "2024-09-02T09:51:59Z",
        "updatedAt": "2024-09-02T09:51:59Z",
        "author": {
          "login": "GangWang01"
        }
      },
      {
        "body": "This issue is marked as stale because feedback has been requested for 30 days with no response. Please respond within 14 days or this issue will be closed due to inactivity.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "createdAt": "2024-10-02T17:02:27Z",
        "updatedAt": "2024-10-02T17:02:27Z",
        "author": {
          "login": "dotnet-policy-service[bot]"
        }
      },
      {
        "body": "This issue was closed due to inactivity. If you can still reproduce this bug, please comment with the requested information, detailed steps to reproduce the problem, or any other notes that might help in the investigation.\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
        "createdAt": "2024-10-25T12:50:33Z",
        "updatedAt": "2024-10-25T12:50:33Z",
        "author": {
          "login": "dotnet-policy-service[bot]"
        }
      }
    ]
  }
}