{
  "number": 5418,
  "title": "Wildcards expansion is silenty skipped when the pattern comes from a complex expression",
  "body": "### Steps to reproduce\r\n\r\nProgrammatically generate a file pattern that contains a wildcard and try to create an item list from it. Compare the results to a hard-coded pattern, or a pattern that comes directly from a property.\r\n\r\nProject file\r\n```xml\r\n<Project xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\" DefaultTargets=\"MyTarget\">\r\n\t<PropertyGroup>\r\n\t\t<MyPattern>*.txt</MyPattern>\r\n\t</PropertyGroup>\r\n\t\r\n\t<ItemGroup>\r\n\t\t<GenItem1 Include=\"*.txt\" />\r\n\t\t<GenItem2 Include=\"$(MyPattern)\" />\r\n\t\t<GenItem3 Include=\"$(MyPattern.Replace('this does', 'nothing'))\" />\r\n\t</ItemGroup>\r\n\t\r\n\t<Target Name=\"MyTarget\">\r\n\t\t<Message Text=\"Direct wildcard: @(GenItem1)\" />\r\n\t\t<Message Text=\"Via property: @(GenItem2)\" />\r\n\t\t<Message Text=\"Via complex expression: @(GenItem3)\" />\r\n\t</Target>\r\n</Project>\r\n```\r\n\r\nDirectory contents:\r\n```\r\n/\r\n- a.txt\r\n- b.txt\r\n```\r\n\r\nCommand line\r\n```\r\nmsbuild my.proj\r\n```\r\n### Expected behavior\r\nWildcards should be expanded according to the final value of the expression, even if it is a complex expression. Output should be:\r\n```\r\nDirect wildcard: a.txt;b.txt\r\nVia property: a.txt;b.txt\r\nVia complex expression: a.txt;b.txt\r\n```\r\n\r\n\r\n### Actual behavior\r\nWhen the pattern is generated by some expression, wildcards are not expanded. Output is:\r\n```\r\nDirect wildcard: a.txt;b.txt\r\nVia property: a.txt;b.txt\r\nVia complex expression: *.txt\r\n```\r\n\r\n### Environment data\r\n`msbuild /version` output: 16.4.0.56107\r\n\r\nOS info: Microsoft Windows [Version 10.0.18363.836]\r\n\r\nIf applicable, version of the tool that invokes MSBuild (Visual Studio, dotnet CLI, etc): CMD\r\n",
  "state": "CLOSED",
  "createdAt": "2020-06-10T07:04:59Z",
  "updatedAt": "2024-02-21T17:03:34Z",
  "closedAt": "2020-06-24T15:59:10Z",
  "author": {
    "login": "yotauber"
  },
  "labels": [
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "This is because [the result of property functions is an escaped string](https://docs.microsoft.com/visualstudio/msbuild/property-functions). If you want to unescape it, you can use the property function `$([MSBuild]::Unescape())`.",
        "createdAt": "2020-06-24T15:59:10Z",
        "updatedAt": "2020-06-24T15:59:16Z",
        "author": {
          "login": "rainersigwald"
        }
      }
    ]
  }
}