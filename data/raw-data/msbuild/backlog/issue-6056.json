{
  "number": 6056,
  "title": "msbuild takes the provided project name as assemblyname, disregarding assemblyname case",
  "body": "<!-- This is a template that helps us provide quicker feedback. Please use any relevant sections and delete anything you don't need. -->\r\n\r\n### Issue Description\r\nAs described, when you build using msbuild (or dotnet msbuild) a project, it uses the provided casing in the filename as for the assemblyname, rather than the assemblyname in the file (\r\n\r\n### Steps to Reproduce\r\n<!--\r\n* Include as much of the following as possible:\r\n\r\n* A minimal sample project that reproduces the issue.\r\n* Your zipped project.\r\n* IDE / CLI steps to create the project and reproduce the behaviour.\r\n* Your command line invocation\r\n-->\r\n\r\ncreate a project (embeddedResourceLib)\r\nadd an embedded resource (gplv2.txt)\r\nbuild using the following command \r\n```\r\ndotnet msbuild {path/to/}embeddedresourcelib.csproj\r\n```\r\npack as a nuget package using the following command\r\n```\r\ndotnet pack --no-build {path/to/}embeddedresourcelib.csproj\r\n```\r\nConsume the nuget package from another package\r\naccess the resourcestream as follows:\r\n```\r\nvar assembly = System.Reflection.Assembly.GetExecutingAssembly();\r\nassembly.GetManifestResourceStream(\"embeddedResourceLib.gplv2.txt\");\r\n```\r\n\r\n### Expected Behavior\r\nGet access to the ResourceStream\r\n\r\n### Actual Behavior\r\nNo resource is found, as the resource is embedded as \r\n```\r\nembeddedresourcelib.gplv2.txt\r\n```\r\n\r\n### Analysis\r\nAs I stated, the compiler seems to take the file argument over the assemblyname provided in the project\r\n\r\n### Versions & Configurations\r\nMicrosoft (R) Build Engine version 16.8.2+25e4d540b for .NET Framework\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n16.8.2.56705\r\n\r\n.NET SDK (5.0.102)\r\n\r\nNuGet Version: 5.6.0.6591\r\n\r\n### Attach a binlog\r\n```\r\n\r\nPS {mypath} dotnet clean\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\nBuild started 1/21/2021 7:21:18 PM.\r\n     1>Project \"mypath\\MinimumReproductionOfToLowerIssue.sln\" on node 1 (Clean target(s)).\r\n     1>ValidateSolutionConfiguration:\r\n         Building solution configuration \"Debug|Any CPU\".\r\n     1>Done Building Project \"mypath\\MinimumReproductionOfToLowerIssue.sln\" (Clean target(s)).\r\n\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:00:00.54\r\n\r\nPS {mypath} dotnet msbuild .\\embeddedResourceLib\\embeddedResourceLib.csproj\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  embeddedResourceLib -> mypath\\embeddedResourceLib\\bin\\Debug\\net472\\embeddedResourceLib.dll\r\n\r\nPS {mypath} dotnet pack --no-build /p:IncludeSymbols=true /p:IncludeSource=true .\\embeddedResourceLib\\embeddedResourceLib.csproj\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  Successfully created package 'mypath\\embeddedResourceLib\\bin\\Debug\\embeddedResourceLib.1.0.0.nupkg'.\r\n  Successfully created package 'mypath\\embeddedResourceLib\\bin\\Debug\\embeddedResourceLib.1.0.0.symbols.nupkg'.\r\n\r\nPS {mypath} c:\\nuget\\nuget.exe push .\\embeddedResourceLib\\bin\\Debug\\*.nupkg  -Source \"D:\\\\NugetUnderground\"\r\nPushing embeddedResourceLib.1.0.0.nupkg to 'D:\\\\NugetUnderground'...\r\nYour package was pushed.\r\nPushing embeddedResourceLib.1.0.0.symbols.nupkg to 'D:\\\\NugetUnderground'...\r\nYour package was pushed.\r\n\r\nPS {mypath} c:\\nuget\\nuget.exe locals all -clear\r\nClearing NuGet HTTP cache: C:\\Users\\3765563\\AppData\\Local\\NuGet\\v3-cache\r\nClearing NuGet global packages folder: C:\\Users\\3765563\\.nuget\\packages\\\r\nClearing NuGet Temp cache: C:\\Users\\3765563\\AppData\\Local\\Temp\\NuGetScratch\r\nClearing NuGet plugins cache: C:\\Users\\3765563\\AppData\\Local\\NuGet\\plugins-cache\r\nLocal resources cleared.\r\n\r\nPS {mypath} dotnet msbuild /restore /p:RestoreSources=\"https://bms-developer.science.uu.nl/nexus/repository/nuget-public/\" /p:RestoreAdditionalProjectSources=\"D:\\\\NugetUnderground\" .\\HecklabCLI1\\embeddedResourceCLI.csproj\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  Determining projects to restore...\r\n  Restored mypath\\HecklabCLI1\\embeddedResourceCLI.csproj (in 204 ms).\r\n  embeddedResourceCLI -> mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.exe\r\n\r\nPS {mypath} & mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.exe\r\nit \r\n[MinimumReproductionOfToLowerIssue.zip](https://github.com/dotnet/msbuild/files/5851456/MinimumReproductionOfToLowerIssue.zip)\r\n\r\nworked\r\n```\r\n```\r\nPS {mypath} dotnet clean\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\nBuild started 1/21/2021 7:22:56 PM.\r\n     1>Project \"mypath\\MinimumReproductionOfToLowerIssue.sln\" on node 1 (Clean target(s)).\r\n     1>ValidateSolutionConfiguration:\r\n         Building solution configuration \"Debug|Any CPU\".\r\n     1>Project \"mypath\\MinimumReproductionOfToLowerIssue.sln\" (1) is building \"mypath\\embeddedResourceLib\\embeddedResourceLib.csproj\" (3) on node 2 (Clean target(s)).\r\n     3>Project \"mypath\\embeddedResourceLib\\embeddedResourceLib.csproj\" (3) is building \"mypath\\embeddedResourceLib\\embeddedResourceLib.csproj\" (3:2) on node 2 (Clean target(s)).\r\n     3>CoreClean:\r\n         Deleting file \"mypath\\embeddedResourceLib\\bin\\Debug\\net472\\embeddedResourceLib.dll\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\bin\\Debug\\net472\\embeddedResourceLib.pdb\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\obj\\Debug\\net472\\embeddedResourceLib.csprojAssemblyReference.cache\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\obj\\Debug\\net472\\embeddedResourceLib.AssemblyInfoInputs.cache\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\obj\\Debug\\net472\\embeddedResourceLib.AssemblyInfo.cs\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\obj\\Debug\\net472\\embeddedResourceLib.csproj.CoreCompileInputs.cache\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\obj\\Debug\\net472\\embeddedResourceLib.dll\".\r\n         Deleting file \"mypath\\embeddedResourceLib\\obj\\Debug\\net472\\embeddedResourceLib.pdb\".\r\n     3>Done Building Project \"mypath\\embeddedResourceLib\\embeddedResourceLib.csproj\" (Clean target(s)).\r\n     3>Done Building Project \"mypath\\embeddedResourceLib\\embeddedResourceLib.csproj\" (Clean target(s)).\r\n     1>Project \"mypath\\MinimumReproductionOfToLowerIssue.sln\" (1) is building \"mypath\\HecklabCLI1\\embeddedResourceCLI.csproj\" (2) on node 1 (Clean target(s)).\r\n     2>Project \"mypath\\HecklabCLI1\\embeddedResourceCLI.csproj\" (2) is building \"mypath\\HecklabCLI1\\embeddedResourceCLI.csproj\" (2:2) on node 1 (Clean target(s)).\r\n     2>CoreClean:\r\n         Deleting file \"mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.exe.config\".\r\n         Deleting file \"mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.exe\".\r\n         Deleting file \"mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.pdb\".\r\n         Deleting file \"mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceLib.dll\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.csprojAssemblyReference.cache\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.AssemblyInfoInputs.cache\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.AssemblyInfo.cs\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.csproj.CoreCompileInputs.cache\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.csproj.CopyComplete\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.exe\".\r\n         Deleting file \"mypath\\HecklabCLI1\\obj\\Debug\\net4.7.2\\embeddedResourceCLI.pdb\".\r\n     2>Done Building Project \"mypath\\HecklabCLI1\\embeddedResourceCLI.csproj\" (Clean target(s)).\r\n     2>Done Building Project \"mypath\\HecklabCLI1\\embeddedResourceCLI.csproj\" (Clean target(s)).\r\n     1>Done Building Project \"mypath\\MinimumReproductionOfToLowerIssue.sln\" (Clean target(s)).\r\n\r\nBuild succeeded.\r\n    0 Warning(s)\r\n    0 Error(s)\r\n\r\nTime Elapsed 00:00:00.75\r\n\r\nPS {mypath} dotnet msbuild .\\embeddedResourceLib\\embeddedresourcelib.csproj\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  embeddedresourcelib -> mypath\\embeddedResourceLib\\bin\\Debug\\net472\\embeddedresourcelib.dll\r\n\r\nPS {mypath} dotnet pack --no-build /p:IncludeSymbols=true /p:IncludeSource=true .\\embeddedResourceLib\\embeddedResourceLib.csproj\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  Successfully created package 'mypath\\embeddedResourceLib\\bin\\Debug\\embeddedResourceLib.1.0.0.nupkg'.\r\n  Successfully created package 'mypath\\embeddedResourceLib\\bin\\Debug\\embeddedResourceLib.1.0.0.symbols.nupkg'.\r\n\r\nPS {mypath} c:\\nuget\\nuget.exe push .\\embeddedResourceLib\\bin\\Debug\\*.nupkg  -Source \"D:\\\\NugetUnderground\"\r\nPushing embeddedResourceLib.1.0.0.nupkg to 'D:\\\\NugetUnderground'...\r\nYour package was pushed.\r\nPushing embeddedResourceLib.1.0.0.symbols.nupkg to 'D:\\\\NugetUnderground'...\r\nYour package was pushed.\r\n\r\nPS {mypath} c:\\nuget\\nuget.exe locals all -clear\r\nClearing NuGet HTTP cache: C:\\Users\\3765563\\AppData\\Local\\NuGet\\v3-cache\r\nClearing NuGet global packages folder: C:\\Users\\3765563\\.nuget\\packages\\\r\nClearing NuGet Temp cache: C:\\Users\\3765563\\AppData\\Local\\Temp\\NuGetScratch\r\nClearing NuGet plugins cache: C:\\Users\\3765563\\AppData\\Local\\NuGet\\plugins-cache\r\nLocal resources cleared.\r\n\r\nPS {mypath} dotnet msbuild /restore /p:RestoreSources=\"https://bms-developer.science.uu.nl/nexus/repository/nuget-public/\" /p:RestoreAdditionalProjectSources=\"D:\\\\NugetUnderground\" .\\HecklabCLI1\\embeddedResourceCLI.csproj\r\nMicrosoft (R) Build Engine version 16.8.3+39993bd9d for .NET\r\nCopyright (C) Microsoft Corporation. All rights reserved.\r\n\r\n  Determining projects to restore...\r\n  Restored mypath\\HecklabCLI1\\embeddedResourceCLI.csproj (in 244 ms).\r\n  embeddedResourceCLI -> mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.exe\r\n\r\nPS {mypath} & mypath\\HecklabCLI1\\bin\\Debug\\net4.7.2\\embeddedResourceCLI.exe\r\n\r\nUnhandled Exception: System.Exception: the resourcestream \"embeddedResourceLib.gplv2.txt\" returned null\r\n   at embeddedResourceCLI.Program.Main(String[] args) in mypath\\HecklabCLI1\\Program.cs:line 21\r\n```",
  "state": "CLOSED",
  "createdAt": "2021-01-21T18:47:59Z",
  "updatedAt": "2022-12-29T22:56:50Z",
  "closedAt": "2022-12-29T19:01:49Z",
  "author": {
    "login": "Bdegraaf1234"
  },
  "labels": [
    "bug",
    "Area: Task: GenerateResource",
    "needs-more-info",
    "needs-triage",
    "stale",
    "closed-by-bot"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "What happens if you manually set the `LogicalName` metadata on your embedded resource to `embeddedResourceLib.gplv2.txt`?",
        "createdAt": "2021-07-22T16:57:07Z",
        "updatedAt": "2021-07-22T16:57:07Z",
        "author": {
          "login": "benvillalobos"
        }
      },
      {
        "body": "This issue is marked as stale because feedback has been requested for 30 days with no response. Please respond within 14 days or this issue will be closed due to inactivity.",
        "createdAt": "2022-12-15T00:02:09Z",
        "updatedAt": "2022-12-15T00:02:09Z",
        "author": {
          "login": "ghost"
        }
      },
      {
        "body": "This issue was closed due to inactivity. If you can still reproduce this bug, please comment with the requested information, detailed steps to reproduce the problem, or any other notes that might help in the investigation.",
        "createdAt": "2022-12-29T19:01:50Z",
        "updatedAt": "2022-12-29T19:01:50Z",
        "author": {
          "login": "ghost"
        }
      },
      {
        "body": "Default resource names start with $(RootNamespace), which defaults to $(MSBuildProjectName) except spaces are replaced with underscores. If you run MSBuild with a differently-cased project file name, then it seems reasonable that $(MSBuildProjectName) and thus $(RootNamespace) would be affected. AssemblyName too defaults to $(MSBuildProjectName) but setting AssemblyName in the project file should not affect resource names; OTOH you could set RootNamespace in the project file instead.",
        "createdAt": "2022-12-29T22:56:47Z",
        "updatedAt": "2022-12-29T22:56:47Z",
        "author": {
          "login": "KalleOlaviNiemitalo"
        }
      }
    ]
  }
}