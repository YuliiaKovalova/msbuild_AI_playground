{
  "number": 3197,
  "title": "[Watson] Evaluation failures due to <TargetFrameworkProfile> containing only a new line & carriage return",
  "body": "### Steps to reproduce\r\n\r\nLooking through project faults data in CPS projects, the vast majority of our project faults (on auto-reload) are due to the following construct. We have well over 1000 hits of this in the past month.\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<Project ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">\r\n  <Import Project=\"$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props\" Condition=\"Exists('$(MSBuildExtensionsPath)\\$(MSBuildToolsVersion)\\Microsoft.Common.props')\" />\r\n  <PropertyGroup>\r\n    <TargetFrameworkVersion>v4.6</TargetFrameworkVersion>\r\n    <TargetFrameworkProfile>&#13;&#10;</TargetFrameworkProfile>\r\n  </PropertyGroup>\r\n  <Import Project=\"$(MSBuildToolsPath)\\Microsoft.CSharp.targets\" />\r\n</Project>\r\n```\r\n\r\nNotice that profile contains the XML equivalent of `\\r\\n`\r\n\r\nThis results in the following evaluation failure:\r\n\r\n```\r\nThe expression \"[System.IO.Path]::Combine(D:\\Temp\\, .NETFramework,Version=v4.5,Profile=\r\n .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets\r\n```\r\n\r\nI'm not sure what tool is causing projects to be in this form - but can we ignore TargetFrameworkProfile if it only contains whitespace?\r\n\r\nException Message (click for more details) | Unique Users | Lifetime Exception Hits | First Seen | Last Seen\r\n:---|---:|---:|---:|---:\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 11 | 150 | 03/08/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 10 | 193 | 03/08/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 8 | 184 | 03/08/2018 | 03/22/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 8 | 141 | 03/08/2018 | 03/22/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETPortable,Version=v5.0,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 7 | 64 | 03/26/2018 | 04/11/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 7 | 16 | 03/13/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 6 | 110 | 03/06/2018 | 03/21/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 6 | 103 | 03/06/2018 | 03/21/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 6 | 11 | 03/13/2018 | 03/20/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETPortable,Version=v5.0,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 5 | 36 | 03/28/2018 | 04/11/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETPortable,Version=v5.0,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 5 | 9 | 03/26/2018 | 04/05/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 4 | 55 | 03/07/2018 | 04/09/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 4 | 44 | 03/07/2018 | 04/09/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.2,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 4 | 4 | 03/29/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(D:\\Temp\\, .NETFramework,Version=v4.5,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 70 | 03/23/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(D:\\Temp\\, .NETFramework,Version=v4.5,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 51 | 03/23/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.2,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 43 | 03/15/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 35 | 03/27/2018 | 03/29/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.2,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 34 | 03/15/2018 | 04/10/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 30 | 03/13/2018 | 03/19/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 25 | 03/27/2018 | 03/29/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 11 | 03/13/2018 | 03/19/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.6.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 7 | 03/09/2018 | 04/05/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 3 | 4 | 03/13/2018 | 04/09/2018\r\nThe expression \"[System.IO.Path]::Combine(C:\\Users\\[UserName]\\AppData\\Local\\Temp\\, .NETFramework,Version=v4.7.1,Profile=  .AssemblyAttributes.cs)\" cannot be evaluated. Illegal characters in path. C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets | 2 | 69 | 03/06/2018 | 04/09/2018\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
  "state": "CLOSED",
  "createdAt": "2018-04-16T08:28:54Z",
  "updatedAt": "2024-02-21T17:13:36Z",
  "closedAt": "2018-04-25T16:52:17Z",
  "author": {
    "login": "davkean"
  },
  "labels": [
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "Thing to note, weird if I copy the string from the original error message, it looks like it has only a carriage return \\r:\r\n\r\n`.NETFramework,Version=v4.6.1,Profile=\\r.AssemblyAttributes.cs`\r\n\r\n@nguerrera mentioned that this is old school Mac format, perhaps VS Mac is adding these?\r\n",
        "createdAt": "2018-04-17T02:39:05Z",
        "updatedAt": "2018-04-17T02:39:05Z",
        "author": {
          "login": "davkean"
        }
      },
      {
        "body": "Perhaps the real fix should be have the XML parser ignore \\r like it does with \\n\\r?",
        "createdAt": "2018-04-17T02:40:51Z",
        "updatedAt": "2018-04-17T02:40:51Z",
        "author": {
          "login": "davkean"
        }
      },
      {
        "body": "Based on very little, I suspect that this is a file that was created with and predominantly has `\\n` line endings, but something edited it with a Windows-style `\\r\\n` in that new property. I think both System.Xml and the editor will treat this as a `\\n` file with an oddball literal character.\r\n\r\nBut I can't repro this that way--I can only get it to happen with the XML entities in the file like your example. Is that what you're seeing, or is it just a stray newline-like character in the file? Or does telemetry not have enough information to tell?",
        "createdAt": "2018-04-17T15:28:26Z",
        "updatedAt": "2018-04-17T15:28:26Z",
        "author": {
          "login": "rainersigwald"
        }
      },
      {
        "body": "No, that is not what I meant to do, sorry.",
        "createdAt": "2018-04-17T21:33:37Z",
        "updatedAt": "2018-04-17T21:33:37Z",
        "author": {
          "login": "rainersigwald"
        }
      }
    ]
  }
}