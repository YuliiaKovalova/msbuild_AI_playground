{
  "number": 11944,
  "title": "[Broken Build]: Working with msbuild and clickOnce profile on self-hosted github actions",
  "body": "### Issue Description\n\nWe have a clickOnce application which we want to build and publish it through CI/CD pipeline on Github Actions.\nWe use our own instances of servercore 2022.\nNo matter what we've tried the build is always failing with various errors.\nWhen running the same commands cli locally on a PC with Visual Studio 2022 it does work.\n\nWhen MSBuildEnableWorkloadResolver is false:\n     error MSB4018: System.IO.FileNotFoundException: Could not load file or assembly \n     'Microsoft.Deployment.DotNet.Releases, Version=2.0.0.0\n\n\nWhen MSBuildEnableWorkloadResolver is true:\nC:\\Program Files\\dotnet\\sdk\\9.0.200\\Sdks\\Microsoft.NET.Sdk\\targets\\Microsoft.NET.Sdk.ImportWorkloads.props(14,3): error : Could not resolve SDK \"Microsoft.NET.SDK.WorkloadAutoImportPropsLocator\". Exactly one of the probing messages below indicates why we could not resolve the SDK. Investigate and resolve that message to correctly specify the SDK.\n\n The NuGetSdkResolver did not resolve this SDK because there was no version specified in the project or global.json.\n\nC:\\Program Files\\dotnet\\sdk\\9.0.200\\Sdks\\Microsoft.NET.Sdk\\targets\\Microsoft.NET.Sdk.ImportWorkloads.props(14,3): error : MSB4276: The default SDK resolver failed to resolve SDK \"Microsoft.NET.SDK.WorkloadAutoImportPropsLocator\" because directory \"C:\\Program Files\\dotnet\\sdk\\9.0.200\\Sdks\\Microsoft.NET.SDK.WorkloadAutoImportPropsLocator\\Sdk\" did not exist.\n\n\nList components:\n .NET SDK:\nVersion:           9.0.200\nCommit:            90e8b202f2\nWorkload version:  9.0.200-manifests.87b8cca8\nMSBuild version:   17.13.8+cbc39bea8\n\nRuntime Environment:\nOS Name:     Windows\nOS Version:  10.0.20348\nOS Platform: Windows\nRID:         win-x64\nBase Path:   C:\\Program Files\\dotnet\\sdk\\9.0.200\\\n\n.NET workloads installed:\nInstallation Source: SDK 9.0.200\nManifest Version:    18.4.9289/9.0.100\nManifest Path:       C:\\Program Files\\dotnet\\sdk-manifests\\9.0.100\\microsoft.net.sdk.maccatalyst\\18.4.9289\\WorkloadManifest.json\nInstall Type:        FileBased\n\n[maui-windows]\nInstallation Source: SDK 9.0.200\nManifest Version:    9.0.51/9.0.100\nManifest Path:       C:\\Program Files\\dotnet\\sdk-manifests\\9.0.100\\microsoft.net.sdk.maui\\9.0.51\\WorkloadManifest.json\nInstall Type:        FileBased\n\nConfigured to use loose manifests when installing new manifests.\n\nHost:\nVersion:      9.0.2\nArchitecture: x64\nCommit:       80aa709f5d\n\n.NET SDKs installed:\n9.0.200 [C:\\Program Files\\dotnet\\sdk]\n.NET runtimes installed:\n\tMicrosoft.AspNetCore.App 9.0.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\n   Microsoft.NETCore.App 8.0.16 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\n   Microsoft.NETCore.App 9.0.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\n   Microsoft.WindowsDesktop.App 9.0.2 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\n\nOther architectures found:\n   None\n \nEnvironment variables:\n   DOTNET_ROOT       [C:\\Program Files\\dotnet]\n\n global.json file:\n   C:\\actions-runner\\_work\\project_name\\project_name\\global.json\n\n\n\n### Steps to Reproduce\n\n1. setup dotnet 9.0.202 with setup-dotnet\n2.  install msbuild with extra tools\n```\nchoco install visualstudio2022buildtools -y `\u00a0 --package-parameters \"--add Microsoft.VisualStudio.Workload.MSBuildTools --add Microsoft.VisualStudio.Component.ClickOnce --includeRecommended --quiet --norestart\" ` --no-progress`\n3.  install workloads:\n```\ndotnet workload install maccatalyst --version 9.0.200\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 dotnet workload install maui-windows --version 9.0.200\n\t\tdotnet workload update\n\t\tdotnet workload restore\n```\n4. dotnet restore\n```\ndotnet nuget locals all --clear\n\u00a0 \u00a0 \u00a0dotnet clean\n\u00a0 \u00a0 \u00a0dotnet restore --locked-mode\n\u00a0 \u00a0 \u00a0dotnet list package\n```\n5. build\n```\n\t msbuild -p:PublishProfile=$profile `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /t:Publish `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /p:Configuration=Release `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /p:PublishProtocol=ClickOnce `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /p:Install=true `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /p:IsWebBootstrapper=true `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /p:InstallFrom=Web `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 /p:TargetFramework=net9.0-windows `\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -verbosity:detailed\n\nenv:\nMSBuildSDKsPath: \"C:\\\\Program Files\\\\dotnet\\\\sdk\\\\9.0.200\\\\Sdks\"\nMSBuildEnableWorkloadResolver: false\nMSBuildExtensionsPath: \"C:\\\\Program Files\\\\dotnet\\\\sdk\\\\9.0.200\\\\Sdks\"\nMSBuildExtensionsPath32: \"C:\\\\Program Files\\\\dotnet\\\\sdk\\\\9.0.200\\\\Sdks\"\n```\n\n\n### Expected Behavior\n\nMsbuild to be able to run and build the cllickOnce application based on given profile.\n\n### Actual Behavior\n\nThe build always fails when running on Github Actions,  although does pass when running locally.\n\n### Ask us questions\n\n_No response_",
  "state": "OPEN",
  "createdAt": "2025-06-03T10:38:14Z",
  "updatedAt": "2025-06-03T10:38:14Z",
  "closedAt": null,
  "author": {
    "login": "mayac-philips"
  },
  "milestone": null,
  "assignees": {
    "nodes": []
  },
  "labels": [],
  "comments": {
    "nodes": [
      {
        "body": "@sujitnayak could you please check if it belongs to your area of the ownership?",
        "createdAt": "2025-06-03T12:04:27Z",
        "updatedAt": "2025-06-03T12:04:27Z",
        "author": {
          "login": "YuliiaKovalova"
        }
      }
    ]
  }
}