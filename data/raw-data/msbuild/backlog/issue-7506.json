{
  "number": 7506,
  "title": " Internal MSBuild Error: \"DefiningProjectFullPath\" is not a valid item-spec modifier",
  "body": "I'm not sure this is a correct repo to file this issue, but `dotnet/installer` dependency update in https://dev.azure.com/dnceng/internal/_git/dotnet-optimization/pullrequest/21940 (https://dev.azure.com/dnceng/internal/_build/results?buildId=1682319&view=logs&j=3052c9a4-5368-55af-482b-1070f1d635d5&t=56e27cfc-3548-5f31-e7e0-7d617b0462b7) broke the build with:\r\n```\r\nMSBUILD : error : This is an unhandled exception in MSBuild -- PLEASE UPVOTE AN EXISTING ISSUE OR FILE A NEW ONE AT https://aka.ms/msbuild/unhandled. [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :     Microsoft.Build.Framework.InternalErrorException: MSB0001: Internal MSBuild Error: \"DefiningProjectFullPath\" is not a valid item-spec modifier. [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Shared.ErrorUtilities.ThrowInternalError(String message, Object[] args) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Shared.FileUtilities.ItemSpecModifiers.GetItemSpecModifier(String currentDirectory, String itemSpec, String definingProjectEscaped, String modifier, String& fullPath) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.BuiltInMetadata.GetMetadataValueEscaped(String currentDirectory, String evaluatedIncludeBeforeWildcardExpansionEscaped, String evaluatedIncludeEscaped, String definingProjectEscaped, String name, String& fullPath) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Execution.ProjectItemInstance.TaskItem.GetBuiltInMetadataEscaped(String name) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Execution.ProjectItemInstance.TaskItem.GetMetadataEscaped(String metadataName) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.MetadataMatchEvaluator.GetMetadataValueFromMatch(Match match) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at System.Text.RegularExpressions.Regex.<>c.<Replace>b__97_0(ValueTuple`5& state, Match match) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at System.Text.RegularExpressions.Regex.RunAllMatchesWithCallbackHelper[TState](ReadOnlySpan`1 input, Int32 startat, TState& state, MatchCallback`1 callback, RegexRunner runner, Boolean usingStringOverload, Boolean reuseMatchObject) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at System.Text.RegularExpressions.Regex.RunAllMatchesWithCallback[TState](String input, Int32 startat, TState& state, MatchCallback`1 callback, Boolean reuseMatchObject) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at System.Text.RegularExpressions.Regex.Replace(MatchEvaluator evaluator, Regex regex, String input, Int32 count, Int32 startat) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.IntrinsicItemFunctions`1.ExpandQuotedExpressionFunction(Expander`2 expander, IElementLocation elementLocation, Boolean includeNullEntries, String functionName, IEnumerable`1 itemsOfType, String[] arguments)+MoveNext() [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.Transform[S](Expander`2 expander, Boolean includeNullEntries, Stack`1 transformFunctionStack, IEnumerable`1 itemsOfType)+MoveNext() [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.Transform[S](Expander`2 expander, Boolean includeNullEntries, Stack`1 transformFunctionStack, IEnumerable`1 itemsOfType)+MoveNext() [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.ExpandExpressionCapture[S](Expander`2 expander, ItemExpressionCapture expressionCapture, IItemProvider`1 evaluatedItems, IElementLocation elementLocation, ExpanderOptions options, Boolean includeNullEntries, Boolean& isTransformExpression, List`1& itemsFromCapture) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.ExpandExpressionCaptureIntoStringBuilder[S](Expander`2 expander, ItemExpressionCapture capture, IItemProvider`1 evaluatedItems, IElementLocation elementLocation, SpanBasedStringBuilder builder, ExpanderOptions options) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.Evaluation.Expander`2.ItemExpander.ExpandItemVectorsIntoString[T](Expander`2 expander, String expression, IItemProvider`1 items, ExpanderOptions options, IElementLocation elementLocation) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskExecutionHost.InitializeTaskScalarParameter(TaskPropertyInfo parameter, Type parameterType, String parameterValue, ElementLocation parameterLocation, Boolean& taskParameterSet) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskExecutionHost.SetTaskParameter(String parameterName, String parameterValue, ElementLocation parameterLocation, Boolean isRequired, Boolean& parameterSet) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.SetTaskParameters(IDictionary`2 parameters) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask(ITaskExecutionHost taskExecutionHost, TaskLoggingContext taskLoggingContext, TaskHost taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.InitializeAndExecuteTask(TaskLoggingContext taskLoggingContext, ItemBucket bucket, IDictionary`2 taskIdentityParameters, TaskHost taskHost, TaskExecutionMode howToExecuteTask) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.ExecuteBucket(TaskHost taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask, Dictionary`2 lookupHash) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.ExecuteTask(TaskExecutionMode mode, Lookup lookup) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TaskBuilder.ExecuteTask(TargetLoggingContext loggingContext, BuildRequestEntry requestEntry, ITargetBuilderCallback targetBuilderCallback, ProjectTargetInstanceChild taskInstance, TaskExecutionMode mode, Lookup inferLookup, Lookup executeLookup, CancellationToken cancellationToken) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TargetEntry.ProcessBucket(ITaskBuilder taskBuilder, TargetLoggingContext targetLoggingContext, TaskExecutionMode mode, Lookup lookupForInference, Lookup lookupForExecution) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TargetEntry.ExecuteTarget(ITaskBuilder taskBuilder, BuildRequestEntry requestEntry, ProjectLoggingContext projectLoggingContext, CancellationToken cancellationToken) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TargetBuilder.ProcessTargetStack(ITaskBuilder taskBuilder) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\nMSBUILD : error :    at Microsoft.Build.BackEnd.TargetBuilder.BuildTargets(ProjectLoggingContext loggingContext, BuildRequestEntry entry, IRequestBuilderCallback callback, String[] targetNames, Lookup baseLookup, CancellationToken cancellationToken) [/__w/1/s/artifacts/out/DotNet_HelloWorld/DotNet_HelloWorld.csproj]\r\n```\r\n\r\ncc @AndyAyersMS @davidwrighton ",
  "state": "CLOSED",
  "createdAt": "2022-03-25T18:29:53Z",
  "updatedAt": "2024-02-21T14:09:15Z",
  "closedAt": "2022-05-22T19:00:51Z",
  "author": {
    "login": "EgorBo"
  },
  "labels": [
    "needs-more-info",
    "stale",
    "closed-by-bot",
    "triaged"
  ],
  "assignees": {
    "nodes": []
  },
  "milestone": null,
  "comments": {
    "nodes": [
      {
        "body": "Team triage:\r\nIs this breaking installer, or is it just something that popped up once?",
        "createdAt": "2022-04-07T17:00:39Z",
        "updatedAt": "2022-04-07T17:00:39Z",
        "author": {
          "login": "Forgind"
        }
      },
      {
        "body": "This issue is marked as stale because feedback has been requested for 30 days with no response. Please respond within 14 days or this issue will be closed due to inactivity.",
        "createdAt": "2022-05-08T00:00:57Z",
        "updatedAt": "2022-05-08T00:00:57Z",
        "author": {
          "login": "ghost"
        }
      },
      {
        "body": "This issue was closed due to inactivity. If you can still reproduce this bug, please comment with the requested information, detailed steps to reproduce the problem, or any other notes that might help in the investigation.",
        "createdAt": "2022-05-22T19:00:52Z",
        "updatedAt": "2022-05-22T19:00:52Z",
        "author": {
          "login": "ghost"
        }
      }
    ]
  }
}