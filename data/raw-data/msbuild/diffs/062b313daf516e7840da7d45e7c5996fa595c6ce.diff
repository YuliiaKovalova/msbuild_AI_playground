diff --git a/src/MSBuild/Resources/Strings.resx b/src/MSBuild/Resources/Strings.resx
index 668b868212c..5d9aa3dbdaf 100644
--- a/src/MSBuild/Resources/Strings.resx
+++ b/src/MSBuild/Resources/Strings.resx
@@ -1278,8 +1278,9 @@ Copyright (C) Microsoft Corporation. All rights reserved.
     </comment>
   </data>
   <data name="EnvironmentVariableAsSwitch" Visibility="Public">
-    <value>Undefined environment variable passed in as switch. Full path: '{0}'</value>
+    <value>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</value>
     <comment>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </comment>
diff --git a/src/MSBuild/Resources/xlf/Strings.cs.xlf b/src/MSBuild/Resources/xlf/Strings.cs.xlf
index 1f8c9ea1a71..7a32ff9dc0d 100644
--- a/src/MSBuild/Resources/xlf/Strings.cs.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.cs.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Všechna práva vyhrazena.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.de.xlf b/src/MSBuild/Resources/xlf/Strings.de.xlf
index 7e087186004..901e3eed027 100644
--- a/src/MSBuild/Resources/xlf/Strings.de.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.de.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Alle Rechte vorbehalten.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.es.xlf b/src/MSBuild/Resources/xlf/Strings.es.xlf
index d72c08faf4d..af08d5550d4 100644
--- a/src/MSBuild/Resources/xlf/Strings.es.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.es.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Todos los derechos reservados.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.fr.xlf b/src/MSBuild/Resources/xlf/Strings.fr.xlf
index 01671c567ad..682d51a283d 100644
--- a/src/MSBuild/Resources/xlf/Strings.fr.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.fr.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Tous droits réservés.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.it.xlf b/src/MSBuild/Resources/xlf/Strings.it.xlf
index bf7141112a8..65a14d6882f 100644
--- a/src/MSBuild/Resources/xlf/Strings.it.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.it.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Tutti i diritti sono riservati.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.ja.xlf b/src/MSBuild/Resources/xlf/Strings.ja.xlf
index a90fee98f28..2ba49c02f6a 100644
--- a/src/MSBuild/Resources/xlf/Strings.ja.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.ja.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation.All rights reserved.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.ko.xlf b/src/MSBuild/Resources/xlf/Strings.ko.xlf
index 3f0674d42f9..78e55f95a14 100644
--- a/src/MSBuild/Resources/xlf/Strings.ko.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.ko.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. All rights reserved.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.pl.xlf b/src/MSBuild/Resources/xlf/Strings.pl.xlf
index 1b9943959bb..9ecd8f80bdb 100644
--- a/src/MSBuild/Resources/xlf/Strings.pl.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.pl.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Wszelkie prawa zastrzeżone.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.pt-BR.xlf b/src/MSBuild/Resources/xlf/Strings.pt-BR.xlf
index 9dff569e1d2..9ffc1ebfb88 100644
--- a/src/MSBuild/Resources/xlf/Strings.pt-BR.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.pt-BR.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. Todos os direitos reservados.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.ru.xlf b/src/MSBuild/Resources/xlf/Strings.ru.xlf
index 62e51c4bc19..d82057e3259 100644
--- a/src/MSBuild/Resources/xlf/Strings.ru.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.ru.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. All rights reserved.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.tr.xlf b/src/MSBuild/Resources/xlf/Strings.tr.xlf
index 3c0000aadd3..48cf4460247 100644
--- a/src/MSBuild/Resources/xlf/Strings.tr.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.tr.xlf
@@ -56,9 +56,10 @@ Telif Hakkı (C) Microsoft Corporation. Tüm hakları saklıdır.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.zh-Hans.xlf b/src/MSBuild/Resources/xlf/Strings.zh-Hans.xlf
index 54a8e4db457..7c63ec2ba3d 100644
--- a/src/MSBuild/Resources/xlf/Strings.zh-Hans.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.zh-Hans.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. All rights reserved.
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/Resources/xlf/Strings.zh-Hant.xlf b/src/MSBuild/Resources/xlf/Strings.zh-Hant.xlf
index 0c0e49e9a38..362d238a7d1 100644
--- a/src/MSBuild/Resources/xlf/Strings.zh-Hant.xlf
+++ b/src/MSBuild/Resources/xlf/Strings.zh-Hant.xlf
@@ -56,9 +56,10 @@ Copyright (C) Microsoft Corporation. 著作權所有，並保留一切權利。
     LOCALIZATION: The prefix "MSBUILD : error MSBxxxx:" should not be localized.</note>
       </trans-unit>
       <trans-unit id="EnvironmentVariableAsSwitch">
-        <source>Undefined environment variable passed in as switch. Full path: '{0}'</source>
-        <target state="new">Undefined environment variable passed in as switch. Full path: '{0}'</target>
+        <source>MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</source>
+        <target state="new">MSBUILD : error MSB1060: Undefined environment variable passed in as switch. Full path: '{0}'</target>
         <note>
+      {StrBegin="MSBUILD : error MSB1060: "}
       UE: This error is shown when a user passes in an environment variable (including from a response file)
       but the environment variable is not defined.
     </note>
diff --git a/src/MSBuild/XMake.cs b/src/MSBuild/XMake.cs
index 261850e29f0..c52ce6076d0 100644
--- a/src/MSBuild/XMake.cs
+++ b/src/MSBuild/XMake.cs
@@ -2001,21 +2001,21 @@ string commandLine
                 // unless the parameters are optional
                 (missingParametersErrorMessage == null))
             {
+                // skip the parameter indicator (if any)
+                if (switchParameters.Length > 0)
+                {
+                    switchParameters = switchParameters.Substring(1);
+                }
+
+                if (parameterizedSwitch == CommandLineSwitches.ParameterizedSwitch.Project && IsEnvironmentVariable(switchParameters))
+                {
+                    commandLineSwitches.SetSwitchError("EnvironmentVariableAsSwitch", unquotedCommandLineArg, commandLine);
+                }
+
                 // check if switch is duplicated, and if that's allowed
                 if (!commandLineSwitches.IsParameterizedSwitchSet(parameterizedSwitch) ||
                     (duplicateSwitchErrorMessage == null))
                 {
-                    // skip the parameter indicator (if any)
-                    if (switchParameters.Length > 0)
-                    {
-                        switchParameters = switchParameters.Substring(1);
-                    }
-
-                    if (parameterizedSwitch == CommandLineSwitches.ParameterizedSwitch.Project && IsEnvironmentVariable(switchParameters))
-                    {
-                        commandLineSwitches.SetSwitchError("EnvironmentVariableAsSwitch", unquotedCommandLineArg, commandLine);
-                    }
-
                     // save the parameters after unquoting and splitting them if necessary
                     if (!commandLineSwitches.SetParameterizedSwitch(parameterizedSwitch, unquotedCommandLineArg, switchParameters, multipleParametersAllowed, unquoteParameters, allowEmptyParameters))
                     {
